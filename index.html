<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Advanced Phrasal Verbs Trainer</title>
  <style>
    :root {
      --primary: #3498db;
      --secondary: #2980b9;
      --accent: #e74c3c;
      --light: #ecf0f1;
      --dark: #2c3e50;
      --success: #2ecc71;
      --warning: #f39c12;
    }

    .audio-alert {
      background-color: #fff3cd;
      color: #856404;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      text-align: center;
      display: none;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      margin: 0;
      padding: 20px;
      color: var(--dark);
      min-height: 100vh;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow: hidden;
      padding-bottom: 20px;
    }
    
    header {
      background: var(--primary);
      color: white;
      padding: 20px;
      text-align: center;
    }
    
    h1 {
      margin: 0;
      font-size: 28px;
    }
    
    .mode-selector {
      display: flex;
      justify-content: center;
      background: var(--light);
      padding: 10px;
    }
    
    .mode-btn {
      padding: 10px 20px;
      margin: 0 5px;
      border: none;
      border-radius: 5px;
      background: white;
      color: var(--dark);
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
    }
    
    .mode-btn.active {
      background: var(--primary);
      color: white;
    }
    
    .content-area {
      padding: 20px;
    }
    
    /* Phrasal Verb Card */
    .phrasal-card {
      background: white;
      border-radius: 10px;
      padding: 25px;
      margin: 20px 0;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      border-left: 5px solid var(--primary);
    }
    
    .phrasal-verb {
      font-size: 32px;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 10px;
      text-align: center;
    }
    
    .verb-meaning {
      font-size: 18px;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .verb-example {
      font-style: italic;
      padding: 15px;
      background: var(--light);
      border-radius: 8px;
      margin-bottom: 20px;
      position: relative;
    }
    
    .verb-example::before {
      content: '"';
      font-size: 40px;
      color: var(--primary);
      opacity: 0.2;
      position: absolute;
      top: -15px;
      left: 5px;
    }
    
    .verb-example::after {
      content: '"';
      font-size: 40px;
      color: var(--primary);
      opacity: 0.2;
      position: absolute;
      bottom: -25px;
      right: 5px;
    }
    
    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    
    button {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      background: var(--primary);
      color: white;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    button:hover {
      background: var(--secondary);
      transform: translateY(-2px);
    }
    
    button.secondary {
      background: var(--light);
      color: var(--dark);
    }
    
    button.accent {
      background: var(--accent);
    }
    
    input[type="text"] {
      padding: 12px 15px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      width: 100%;
      max-width: 500px;
      margin: 10px 0;
    }
    
    .feedback {
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      text-align: center;
      font-weight: 600;
    }
    
    .correct {
      background: rgba(46, 204, 113, 0.2);
      color: var(--success);
    }
    
    .incorrect {
      background: rgba(231, 76, 60, 0.2);
      color: var(--accent);
    }
    
    .stats-container {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    
    .stat-box {
      background: white;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      min-width: 120px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    }
    
    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--primary);
    }
    
    .progress-bar {
      height: 10px;
      background: #eee;
      border-radius: 5px;
      margin-top: 20px;
      overflow: hidden;
    }
    
    .progress {
      height: 100%;
      background: var(--success);
      width: 0%;
      transition: width 0.5s;
    }
    
    .hidden {
      display: none !important;
    }
    
    .category-selector {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin: 20px 0;
    }
    
    .category-btn {
      padding: 8px 15px;
      background: white;
      border: 2px solid var(--light);
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .category-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }
    
    @media (max-width: 768px) {
      .phrasal-verb {
        font-size: 24px;
      }
      
      button {
        padding: 10px 15px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="audio-alert" id="audioAlert">
    üîà Por favor toca cualquier parte de la pantalla para activar el audio
  </div>
  <div class="container">
    <header>
      <h1>Advanced Phrasal Verbs Trainer</h1>
    </header>
    
    <div class="mode-selector">
      <button class="mode-btn active" onclick="showMode('learn')">Learn</button>
      <button class="mode-btn" onclick="showMode('practice')">Practice</button>
      <button class="mode-btn" onclick="showMode('stats')">Statistics</button>
    </div>
    
    <!-- Learn Mode -->
    <div id="learn-mode" class="content-area">
      <div class="category-selector">
        <div class="category-btn active" data-category="all">All</div>
        <div class="category-btn" data-category="common">Most Common</div>
        <div class="category-btn" data-category="work">Work</div>
        <div class="category-btn" data-category="travel">Travel</div>
        <div class="category-btn" data-category="social">Social</div>
      </div>
      
      <div class="phrasal-card">
        <div class="phrasal-verb" id="current-verb">take off</div>
        <div class="verb-meaning" id="current-meaning">to remove something (especially clothing) or to depart (airplane)</div>
        <div class="verb-example" id="current-example">"Please take off your shoes before entering the house."</div>
        
        <div class="controls">
          <button onclick="speakPhrasalVerb()"><span>üîä</span> Listen</button>
          <button onclick="speakSlowly()"><span>üê¢</span> Slow</button>
          <button class="secondary" onclick="showTranslation()"><span>üëÄ</span> Show Meaning</button>
          <button class="secondary" onclick="showExample()"><span>üí°</span> Show Example</button>
          <button onclick="nextPhrasalVerb()"><span>‚û°Ô∏è</span> Next</button>
        </div>
      </div>
      
      <div class="practice-box hidden" id="practice-box">
        <h3>Practice Time!</h3>
        <p>What does "<span id="practice-verb">take off</span>" mean?</p>
        <input type="text" id="practice-answer" placeholder="Enter the meaning...">
        <div class="controls">
          <button onclick="checkAnswer()">Check Answer</button>
        </div>
        <div class="feedback hidden" id="practice-feedback"></div>
      </div>
    </div>
    
    <!-- Practice Mode -->
    <div id="practice-mode" class="content-area hidden">
      <h2>Test Your Knowledge</h2>
      <div class="quiz-container" id="quiz-container">
        <p>Complete the sentence:</p>
        <p class="verb-example" id="quiz-sentence">"I need to _____ _____ my shoes before entering." (take off)</p>
        <input type="text" id="quiz-answer" placeholder="Type the phrasal verb...">
        <div class="controls">
          <button onclick="checkQuiz()">Submit</button>
          <button class="secondary" onclick="hintQuiz()">Hint</button>
        </div>
        <div class="feedback hidden" id="quiz-feedback"></div>
      </div>
      
      <div class="stats-container">
        <div class="stat-box">
          <div class="stat-value" id="quiz-correct">0</div>
          <div>Correct</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="quiz-wrong">0</div>
          <div>Wrong</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="quiz-streak">0</div>
          <div>Streak</div>
        </div>
      </div>
    </div>
    
    <!-- Statistics Mode -->
    <div id="stats-mode" class="content-area hidden">
      <h2>Your Progress</h2>
      
      <div class="stats-container">
        <div class="stat-box">
          <div class="stat-value" id="stats-learned">12</div>
          <div>Learned</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="stats-practicing">8</div>
          <div>Practicing</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="stats-mastered">4</div>
          <div>Mastered</div>
        </div>
      </div>
      
      <h3>Progress</h3>
      <div class="progress-bar">
        <div class="progress" id="progress-bar" style="width: 35%;"></div>
      </div>
      
      <h3>Recently Learned</h3>
      <div class="learned-list" id="learned-list">
        <!-- Filled by JavaScript -->
      </div>
    </div>
  </div>

  <script>
    // ===== 1. SOLUCI√ìN PARA DESBLOQUEAR AUDIO EN M√ìVILES =====
    let audioEnabled = false;
    const audioAlert = document.getElementById('audioAlert');

    function enableAudio() {
      if (audioEnabled) return;
      
      const audio = new Audio();
      audio.src = 'data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU...';
      audio.volume = 0.001;
      
      audio.play()
        .then(() => {
          audioEnabled = true;
          audioAlert.style.display = 'none';
        })
        .catch(e => {
          audioAlert.style.display = 'block';
        });
    }

    // Activar con cualquier interacci√≥n
    document.addEventListener('click', enableAudio, { once: true });
    document.addEventListener('touchstart', enableAudio, { once: true });
    document.addEventListener('keydown', enableAudio, { once: true });

    // ===== 2. FUNCIONES DE AUDIO MEJORADAS =====
    const audioFiles = {
      "take off": "https://ssl.gstatic.com/dictionary/static/sounds/20200429/take_off--_gb_1.mp3",
      "put off": "https://ssl.gstatic.com/dictionary/static/sounds/20200429/put_off--_gb_1.mp3",
      "look up": "https://ssl.gstatic.com/dictionary/static/sounds/20200429/look_up--_gb_1.mp3",
      "give up": "https://ssl.gstatic.com/dictionary/static/sounds/20200429/give_up--_gb_1.mp3",
      "turn on": "https://ssl.gstatic.com/dictionary/static/sounds/20200429/turn_on--_gb_1.mp3",
      "carry out": "https://ssl.gstatic.com/dictionary/static/sounds/20200429/carry_out--_gb_1.mp3"
    };

    function speakText(text, rate = 1) {
      if (!audioEnabled) {
        audioAlert.style.display = 'block';
        return;
      }

      if (!('speechSynthesis' in window)) {
        fallbackAudio(text);
        return;
      }

      const utterance = new SpeechSynthesisUtterance();
      utterance.text = text;
      utterance.lang = 'en-US';
      utterance.rate = Math.min(rate, 1.2);
      utterance.volume = 1.0;

      utterance.onerror = () => fallbackAudio(text);
      
      speechSynthesis.cancel();
      setTimeout(() => speechSynthesis.speak(utterance), 100);
    }

    function fallbackAudio(verb) {
      if (audioFiles[verb]) {
        new Audio(audioFiles[verb]).play().catch(e => {
          alert("Error al reproducir audio para: " + verb);
        });
      }
    }

    function speakPhrasalVerb() {
      const verbs = getFilteredVerbs();
      const currentVerb = verbs[currentVerbIndex];
      
      if (!audioEnabled) {
        audioAlert.style.display = 'block';
        return;
      }

      speakText(currentVerb.verb);
    }

    function speakSlowly() {
      const verbs = getFilteredVerbs();
      const currentVerb = verbs[currentVerbIndex];
      speakText(currentVerb.verb, 0.7);
    }

    // ===== 3. RESTAURAR EL RESTO DE TU C√ìDIGO ORIGINAL =====
    // [Todo el resto de tus funciones existentes permanecen igual]
    // ===== Phrasal Verbs Database =====
    const phrasalVerbs = [
      // Common
      { verb: "take off", translation: "quitarse/despegar", example: "The plane takes off at 3 PM.", category: "common" },
      { verb: "put off", translation: "posponer", example: "Don't put off your homework.", category: "common" },
      { verb: "look up", translation: "buscar (informaci√≥n)", example: "I'll look up the address online.", category: "common" },
      { verb: "give up", translation: "rendirse", example: "Never give up on your dreams.", category: "common" },
      { verb: "turn on", translation: "encender", example: "Can you turn on the lights?", category: "common" },
      
      // Work
      { verb: "carry out", translation: "llevar a cabo", example: "We need to carry out more research.", category: "work" },
      { verb: "draw up", translation: "redactar", example: "The lawyer will draw up the contract.", category: "work" },
      { verb: "hand in", translation: "entregar", example: "Please hand in your reports by Friday.", category: "work" },
      { verb: "take over", translation: "hacerse cargo", example: "She will take over as manager next month.", category: "work" },
      
      // Travel
      { verb: "check in", translation: "registrarse", example: "We need to check in at the hotel.", category: "travel" },
      { verb: "get on", translation: "subir (transporte)", example: "Quick, get on the bus!", category: "travel" },
      { verb: "see off", translation: "despedir", example: "They came to see me off at the airport.", category: "travel" },
      
      // Social
      { verb: "get along", translation: "llevarse bien", example: "Do you get along with your neighbors?", category: "social" },
      { verb: "hang out", translation: "pasar el rato", example: "Let's hang out this weekend.", category: "social" },
      { verb: "run into", translation: "encontrarse con", example: "I ran into an old friend yesterday.", category: "social" }
    ];

    // ===== App State =====
    let currentVerbIndex = 0;
    let currentCategory = "all";
    let userProgress = {};
    let practiceStats = {
      correct: 0,
      wrong: 0,
      streak: 0
    };

    // ===== Initialize App =====
    document.addEventListener('DOMContentLoaded', function() {
      // Load user progress from localStorage
      const savedProgress = localStorage.getItem('phrasalVerbProgress');
      if (savedProgress) {
        userProgress = JSON.parse(savedProgress);
      } else {
        // Initialize progress
        phrasalVerbs.forEach(verb => {
          userProgress[verb.verb] = {
            views: 0,
            correct: 0,
            wrong: 0,
            lastPracticed: null,
            mastered: false
          };
        });
      }
      
      // Set up category buttons
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          currentCategory = this.dataset.category;
          currentVerbIndex = 0;
          displayCurrentPhrasalVerb();
        });
      });
      
      // Display first verb
      displayCurrentPhrasalVerb();
      updateStats();
    });

    // ===== Main Functions =====
    function displayCurrentPhrasalVerb() {
      const verbs = getFilteredVerbs();
      if (verbs.length === 0) {
        document.getElementById('current-verb').textContent = "No verbs in this category";
        return;
      }
      
      if (currentVerbIndex >= verbs.length) {
        currentVerbIndex = 0;
      }
      
      const currentVerb = verbs[currentVerbIndex];
      document.getElementById('current-verb').textContent = currentVerb.verb;
      document.getElementById('current-meaning').textContent = currentVerb.translation;
      document.getElementById('current-example').textContent = currentVerb.example;
      
      // Hide meaning and example initially
      document.getElementById('current-meaning').style.visibility = 'hidden';
      document.getElementById('current-example').style.visibility = 'hidden';
      
      // Update progress
      userProgress[currentVerb.verb].views++;
      saveProgress();
    }

    function getFilteredVerbs() {
      if (currentCategory === "all") return phrasalVerbs;
      return phrasalVerbs.filter(verb => verb.category === currentCategory);
    }

    function nextPhrasalVerb() {
      const verbs = getFilteredVerbs();
      currentVerbIndex = (currentVerbIndex + 1) % verbs.length;
      displayCurrentPhrasalVerb();
      
      // Hide practice box
      document.getElementById('practice-box').classList.add('hidden');
    }

    function showTranslation() {
      document.getElementById('current-meaning').style.visibility = 'visible';
    }

    function showExample() {
      document.getElementById('current-example').style.visibility = 'visible';
    }

    function startPractice() {
      document.getElementById('practice-box').classList.remove('hidden');
      const verbs = getFilteredVerbs();
      const currentVerb = verbs[currentVerbIndex];
      document.getElementById('practice-verb').textContent = currentVerb.verb;
      document.getElementById('practice-answer').value = '';
      document.getElementById('practice-feedback').classList.add('hidden');
    }

    function checkAnswer() {
      const verbs = getFilteredVerbs();
      const currentVerb = verbs[currentVerbIndex];
      const userAnswer = document.getElementById('practice-answer').value.trim().toLowerCase();
      const correctAnswer = currentVerb.translation.toLowerCase();
      
      const feedback = document.getElementById('practice-feedback');
      feedback.classList.remove('hidden');
      
      if (userAnswer === correctAnswer) {
        feedback.textContent = "‚úÖ Correct! Well done!";
        feedback.className = "feedback correct";
        userProgress[currentVerb.verb].correct++;
        practiceStats.correct++;
        practiceStats.streak++;
      } else {
        feedback.textContent = `‚ùå Incorrect. The correct meaning is: "${currentVerb.translation}"`;
        feedback.className = "feedback incorrect";
        userProgress[currentVerb.verb].wrong++;
        practiceStats.wrong++;
        practiceStats.streak = 0;
      }
      
      saveProgress();
      updateStats();
    }

    // ===== Quiz Functions =====
    function startQuiz() {
      const verbs = getFilteredVerbs();
      const randomVerb = verbs[Math.floor(Math.random() * verbs.length)];
      const example = randomVerb.example;
      
      // Replace the phrasal verb with blanks
      const blankedExample = example.replace(randomVerb.verb, "_____ _____");
      
      document.getElementById('quiz-sentence').textContent = blankedExample + ` (${randomVerb.translation})`;
      document.getElementById('quiz-answer').value = '';
      document.getElementById('quiz-feedback').classList.add('hidden');
      document.getElementById('quiz-answer').focus();
    }

    function checkQuiz() {
      const verbs = getFilteredVerbs();
      const answer = document.getElementById('quiz-answer').value.trim().toLowerCase();
      const currentExample = document.getElementById('quiz-sentence').textContent;
      
      // Find the verb that matches the example
      const currentVerb = verbs.find(v => currentExample.includes(v.example.replace(v.verb, "_____ _____")));
      
      if (!currentVerb) {
        alert("Error: Couldn't find current verb");
        return;
      }
      
      const feedback = document.getElementById('quiz-feedback');
      feedback.classList.remove('hidden');
      
      if (answer === currentVerb.verb.toLowerCase()) {
        feedback.textContent = "‚úÖ Correct! Excellent!";
        feedback.className = "feedback correct";
        userProgress[currentVerb.verb].correct++;
        practiceStats.correct++;
        practiceStats.streak++;
      } else {
        feedback.textContent = `‚ùå Incorrect. The correct phrasal verb is: "${currentVerb.verb}"`;
        feedback.className = "feedback incorrect";
        userProgress[currentVerb.verb].wrong++;
        practiceStats.wrong++;
        practiceStats.streak = 0;
      }
      
      saveProgress();
      updateStats();
      
      // Start new quiz after delay
      setTimeout(startQuiz, 1500);
    }

    function hintQuiz() {
      const currentExample = document.getElementById('quiz-sentence').textContent;
      const verbs = getFilteredVerbs();
      const currentVerb = verbs.find(v => currentExample.includes(v.example.replace(v.verb, "_____ _____")))?.verb;
      
      if (currentVerb) {
        const firstWord = currentVerb.split(' ')[0];
        document.getElementById('quiz-answer').value = firstWord + " ";
        document.getElementById('quiz-answer').focus();
      }
    }

    // ===== Progress Tracking =====
    function saveProgress() {
      localStorage.setItem('phrasalVerbProgress', JSON.stringify(userProgress));
    }

    function updateStats() {
      // Update practice stats
      document.getElementById('quiz-correct').textContent = practiceStats.correct;
      document.getElementById('quiz-wrong').textContent = practiceStats.wrong;
      document.getElementById('quiz-streak').textContent = practiceStats.streak;
      
      // Update overall stats
      const totalVerbs = phrasalVerbs.length;
      const learnedVerbs = Object.values(userProgress).filter(v => v.views > 0).length;
      const practicingVerbs = Object.values(userProgress).filter(v => v.correct > 0).length;
      const masteredVerbs = Object.values(userProgress).filter(v => v.correct >= 3).length;
      
      document.getElementById('stats-learned').textContent = learnedVerbs;
      document.getElementById('stats-practicing').textContent = practicingVerbs;
      document.getElementById('stats-mastered').textContent = masteredVerbs;
      
      // Update progress bar
      const progressPercent = Math.round((masteredVerbs / totalVerbs) * 100);
      document.getElementById('progress-bar').style.width = `${progressPercent}%`;
      
      // Update recently learned list
      updateLearnedList();
    }

    function updateLearnedList() {
      const learnedList = document.getElementById('learned-list');
      learnedList.innerHTML = '';
      
      // Get verbs sorted by last practiced
      const sortedVerbs = [...phrasalVerbs].sort((a, b) => {
        const dateA = userProgress[a.verb]?.lastPracticed || 0;
        const dateB = userProgress[b.verb]?.lastPracticed || 0;
        return dateB - dateA;
      });
      
      // Show top 5 recently practiced
      const recentVerbs = sortedVerbs.slice(0, 5);
      recentVerbs.forEach(verb => {
        const progress = userProgress[verb.verb];
        if (progress.views > 0) {
          const item = document.createElement('div');
          item.className = 'phrasal-card';
          item.innerHTML = `
            <strong>${verb.verb}</strong>: ${verb.translation}
            <div style="margin-top: 10px; font-size: 14px;">
              <span style="color: var(--success);">‚úì ${progress.correct}</span> | 
              <span style="color: var(--accent);">‚úó ${progress.wrong}</span>
            </div>
          `;
          learnedList.appendChild(item);
        }
      });
    }

    // ===== Mode Switching =====
    function showMode(mode) {
      // Update active button
      document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent.toLowerCase().includes(mode)) {
          btn.classList.add('active');
        }
      });
      
      // Hide all content areas
      document.querySelectorAll('.content-area').forEach(area => {
        area.classList.add('hidden');
      });
      
      // Show selected mode
      document.getElementById(`${mode}-mode`).classList.remove('hidden');
      
      // Initialize mode if needed
      if (mode === 'practice') {
        startQuiz();
      } else if (mode === 'stats') {
        updateStats();
      }
    }
  </script>
</body>
</html>
```

### üöÄ Cambios realizados:

1. **Sistema de desbloqueo de audio**:
   - A√±adido mensaje de alerta visible
   - Activaci√≥n con cualquier interacci√≥n (click, touch, teclado)
   - Audio silencioso para desbloquear reproducci√≥n

2. **Funciones de voz mejoradas**:
   - `speakText()` ahora incluye:
     - Verificaci√≥n de audio habilitado
     - Fallback a audio pregrabado
     - Configuraci√≥n optimizada para m√≥viles
   - Se a√±adieron archivos de audio reales de Google Dictionary

3. **Manejo de errores robusto**:
   - Captura de errores en s√≠ntesis de voz
   - Feedback visual cuando hay problemas

4. **Optimizaci√≥n m√≥vil**:
   - Velocidad de habla reducida en m√≥viles
   - M√∫ltiples eventos de activaci√≥n (touchstart)

### üì± Para probar en tu m√≥vil:
1. Toca cualquier parte de la pantalla primero
2. Espera a que desaparezca el mensaje amarillo
3. Ahora los botones de audio funcionar√°n correctamente

¬øNecesitas alguna otra mejora o ajuste en el c√≥digo?
